(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{18704:(e,t,s)=>{Promise.resolve().then(s.bind(s,71099))},71099:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(95155),r=s(547),l=s(63259),i=s(35007),n=s(285),d=s(58581),c=s(94973),o=s(15255),m=s(12800),x=s(66963),u=s(27112),h=s(16161),f=s(7793),j=s(91880),p=s(33719);function v(){let e=(0,l.U)(),{data:t,isLoading:s}=(0,r.I)({queryKey:["dashboard"],queryFn:async()=>{let t=new Date,s=(0,f.e)(t,30),a=function(e,t){let s=(0,j.a)(e,void 0);return s.setDate(1),s.setHours(0,0,0,0),s}(t),[{data:r},{data:l},{data:i},{data:n}]=await Promise.all([e.from("menu_items").select("id, name, is_available"),e.from("categories").select("id, name"),e.from("menu_item_views").select("menu_item_id, viewed_at").gte("viewed_at",s.toISOString()),e.from("menu_item_views").select("id").gte("viewed_at",a.toISOString())]);if(!r||!l||!i||!n)throw Error("Failed to fetch data");let d=Array.from({length:30},(e,s)=>{let a=(0,f.e)(t,29-s),r=i.filter(e=>new Date(e.viewed_at).toDateString()===a.toDateString());return{date:(0,p.GP)(a,"MMM d"),views:r.length}}),c=r.map(e=>({name:e.name,views:i.filter(t=>t.menu_item_id===e.id).length})).sort((e,t)=>t.views-e.views);return{totalViews:n.length,totalItems:r.length,activeItems:r.filter(e=>e.is_available).length,totalCategories:l.length,dailyViews:d,popularItems:c.slice(0,5)}}});return(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Welcome back"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Here's an overview of your restaurant's performance"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Views"}),(0,a.jsx)(n.F.chart,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?"...":null==t?void 0:t.totalViews.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Menu views this month"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Menu Items"}),(0,a.jsx)(n.F.list,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?"...":null==t?void 0:t.activeItems.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active menu items"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Categories"}),(0,a.jsx)(n.F.list,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?"...":null==t?void 0:t.totalCategories.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Menu categories"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"QR Codes"}),(0,a.jsx)(n.F.qr,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:"1"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active QR codes"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[(0,a.jsxs)(i.Zp,{className:"col-span-4",children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"Overview"})}),(0,a.jsx)(i.Wu,{children:s?(0,a.jsx)("div",{className:"h-[350px] flex items-center justify-center",children:"Loading..."}):(null==t?void 0:t.dailyViews.length)===0?(0,a.jsx)("div",{className:"h-[350px] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"No data yet"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Views will appear here once customers start using your menu"})]})}):(0,a.jsx)("div",{className:"h-[350px]",children:(0,a.jsx)(d.u,{width:"100%",height:"100%",children:(0,a.jsxs)(c.b,{data:null==t?void 0:t.dailyViews,children:[(0,a.jsx)(o.d,{strokeDasharray:"3 3"}),(0,a.jsx)(m.W,{dataKey:"date",tick:{fontSize:12},interval:"preserveStartEnd"}),(0,a.jsx)(x.h,{tick:{fontSize:12}}),(0,a.jsx)(u.m,{}),(0,a.jsx)(h.N,{type:"monotone",dataKey:"views",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})})]}),(0,a.jsxs)(i.Zp,{className:"col-span-3",children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"Popular Items"})}),(0,a.jsx)(i.Wu,{children:s?(0,a.jsx)("div",{children:"Loading..."}):(null==t?void 0:t.popularItems.length)===0?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"No data yet"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add menu items to see analytics"})]}):(0,a.jsx)("div",{className:"space-y-4",children:null==t?void 0:t.popularItems.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm truncate flex-1",children:e.name}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[e.views.toLocaleString()," views"]})]},t))})})]})]})]})}},35007:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>m});var a=s(95155),r=s(12115),l=s(29602);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});i.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});m.displayName="CardFooter"},285:(e,t,s)=>{"use strict";s.d(t,{F:()=>y});var a=s(88218),r=s(40767),l=s(70001),i=s(93518),n=s(46967),d=s(86710),c=s(22104),o=s(87725),m=s(98867),x=s(15800),u=s(33473),h=s(28527),f=s(68236),j=s(77568),p=s(60872),v=s(27530),g=s(28701),N=s(19993),w=s(23920);let y={logo:a.A,close:r.A,spinner:l.A,chevronLeft:i.A,chevronRight:n.A,menu:d.A,moon:c.A,sun:o.A,check:m.A,chevronsUpDown:x.A,add:u.A,chart:h.A,settings:f.A,qr:j.A,edit:p.A,grip:v.A,list:g.A,trash:N.A,copy:w.A}},63259:(e,t,s)=>{"use strict";s.d(t,{U:()=>r});var a=s(9806);function r(){return(0,a.createClientComponentClient)()}},29602:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(43463),r=s(69795);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},98867:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82800).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[1181,5593,9806,7527,547,2043,5067,8441,1517,7358],()=>t(18704)),_N_E=e.O()}]);